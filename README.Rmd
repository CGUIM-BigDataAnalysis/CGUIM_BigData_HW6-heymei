---
title: "台北市竊盜事件探討"
output: github_document
---

## 組員
陳哲安
劉喜媚

## 分析議題背景
台北市為全台灣的政經中心，聚集了各式各樣的人才、企業，也因此人口流動快速。然而，人口眾多相對也容易造成一些竊盜的事件發生，
如何有效的去預防、追查竊盜事件發生，也是當務之急。

## 分析動機
生為台灣的首都，許多的竊盜事件都容易影響台灣的形象，因此如何有效的預防、追查竊盜事件是很重要的。預計透過台北市人口資料、警察局分配位置、竊盜事件發生位置來探討個區域的安全性，或是作為警察局建立攝影機的參考。

## 使用資料
1.臺北市汽車竊盜點位資訊
來源：台北市政府資料開放平台
資料類型：CSV
主要欄位：案類(Type)、發生(現)日期(Date) 、發生時段(Time)、地點(Location) 
日期：106年03月13日

2.臺北市自行車竊盜點位資訊
來源：台北市政府資料開放平台
資料類型：CSV
主要欄位：案類(Type)、發生(現)日期(Date) 、發生時段(Time)、地點(Location) 
日期：106年03月13日

3.臺北市政府警察局名稱及地址
來源：台北市政府資料開放平台
資料類型：CSV
主要欄位：標題、內容、交通資訊、顯示用地址、系統辨識用地址  
日期：106年03月14日

4.村里戶數、單一年齡人口
來源：內政部資料開放平台
資料類型：CSV
主要欄位：戶數、單一年齡性別、單一年齡人口數 
日期：106年01月18日

5.鄉鎮市區界線(TWD97經緯度)
來源：政府資料開放平台
資料類型：SHP
主要欄位：鄉(鎮、市、區)界線(TWD97經緯度)
日期：104年10月07日


載入使用資料們
```{r}
#install.packages("data.table")
library(data.table)
car <- fread("~/Desktop/R Final/txt/car.txt" ,colClasses = "character")
bike <- fread("~/Desktop/R Final/txt/bike.txt" ,colClasses = "character")
police <- fread("~/Desktop/R Final/txt/police.txt" ,colClasses = "character")
people <- fread("~/Desktop/R Final/opendata10512M030.csv",colClasses = "character" , skip = 1)


```

## 資料處理與清洗
- 從台灣總人口數的表，清出只有台北市的資料，再去統整台北市各區域的人口數
- 統計台北市各區域汽車偷竊次數
- 統計台北市各區域自行車偷竊次數
- 統計台北市各區域警察局量

處理資料
```{r}
library(dplyr)
##人口表
##people_taipei 只有台北市的人口資料
##people_taipei_area 台北市各區域的總人口，男生人口，女生人口
people_taipei <- people[grepl("臺北市",people$區域別),]
people_taipei_area <- group_by(people_taipei,區域別) %>% summarise(people_total = sum(as.numeric(人口數)) , people_man = sum(as.numeric(`人口數-男`)) , people_woman = sum(as.numeric(`人口數-女`)))
people_taipei_area$地區 <- substr(people_taipei_area$區域別 , start = 4 , stop = 6)

##汽車偷竊
##cartotal 台北市各區域汽車偷竊次數
car$地區 <- substr(car$`發生(現)地點`,start = 4,stop = 6)
cartotal <- group_by(car,地區) %>% summarise(carnumber = n()) #地區&時段

##自行車偷竊
##biketotal 台北市各區域自行車偷竊次數
bike$地區 <- substr(bike$`發生(現)地點` , start = 4 , stop = 6) 
biketotal <- group_by(bike,地區) %>% summarise(bikenumber = n())

##警察局
##台北市各區域警察局總數
police$地區 <- substr(police$poi_addr , start = 4 , stop = 6)
policetotal <-  group_by(police,地區) %>% summarise(policenumber = n())

##資料結合
##merge3 有台北市各區域總人口、男生人口數、女生人口數、汽車發生偷竊次數、自行車發生偷竊次數、警察局總數
merge1 <- full_join(people_taipei_area,cartotal,by="地區")
merge2 <- full_join(merge1,biketotal,by="地區")
merge3 <- full_join(merge2,policetotal,by="地區")
```

## 探索式資料分析
圖文並茂圖文並茂
```{r}
#這是R Code Chunk

# install.packages("showtext")
library(showtext)
showtext.auto(enable = TRUE)

library(ggplot2)
merge3<-mutate(merge3, "竊盗總數"=carnumber+bikenumber)

summary(merge3$bikenumber)
hist.bike<-merge3$bikenumber
names(hist.bike)<-merge3$地區
summary(merge3$carnumber)
hist.car<-merge3$carnumber
names(hist.car)<-merge3$地區
x.par <- par(mfrow = c(1,2))
barplot(hist.car, xlab = "區域別", ylab = "次數", main ="車在各區被竊盗的次數",density=5, family = "HanziPen TC Regular")
barplot(hist.bike, xlab = "區域別", ylab = "次數", main ="自行車在各區被竊盗的次數",density=5, ylim=c(0, 140), family = "HanziPen TC Regular")
par(x.par)
#車被竊盗的量比自行車的量高出很多 

shapiro.test(merge3$竊盗總數)  
#不服從常態分配
cor(merge3$竊盗總數, merge3$policenumber) 
#各區警察局的數量與竊盗總數的相關係數皆趨近於零，線性關係很底。
cov(merge3$竊盗總數, merge3$policenumber) 
#各區警察局的數量與竊盗總數的共變異數的絕對值皆<2,線性關係很弱。

steal.car<- rbind(car,bike)
steal.car1<-steal.car[,c(2,4,6)]
steal.car1<- group_by(steal.car1, 地區)%>%
            mutate("竊盗總數"= n())
steal.car2<- steal.car1[!duplicated(steal.car1[, c("發生時段", "地區", "案類")]),] 
steal.car2 <- full_join(steal.car2,policetotal,by="地區")
steal.car2 <- full_join(steal.car2, people_taipei_area[, c(2,5)],by="地區")
#取得各區在某時段的竊盗總數、總人口數、警察局數

par(font.axis = 2)
par(font.lab = 2)
qplot(竊盗總數, policenumber, data = steal.car2, main="各區域竊盜事件數與警察局的分佈相關性",xlab = "竊盜事件數", ylab = "警察局數量", color = 發生時段)+theme(text=element_text(family = "HanziPen TC Regular", size=12))
qplot(竊盗總數, people_total, data = steal.car2, main="各區域竊盜事件數與總人口數相關性",xlab = "竊盜事件數", ylab = "總人口數", color = 發生時段) +theme(text=element_text(family = "HanziPen TC Regular", size=12))
#可見人口與警察局的多寡不防礙竊盜的發生，竊盗發生的時間沒有集中的趨勢

qplot(地區, data = steal.car, main="各區域竊盜事件數")+theme(text=element_text(family = "HanziPen TC Regular", size=12))
# 大安區與北投區發生竊盗事件最高。
```

## 期末專題分析規劃
期末專題要做台北市竊盜分析

試着分析車與自行車被竊量的差異的原因
假設：
竊盗車的成功率比車高
車的比較能吸引竊盗者
大家丟失自行車不一定會去報案

各區的竊盗事件發生不均，試着以各區的收入水平作考量；
以竊盗地點作分析（該地點的特徵，如集中在學校附近）
假設：
收入水平較高的地區竊盗事件較多
特定場所會增加竊盗的發生

探討能減底竊盗事件的因素：
假設：
人口密度能防礙竊盗發生
攝影機數能防礙竊盗發生

                 
