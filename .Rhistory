freq_location_taipei<-camera_need[,.N,by = 地區]
colnames(freq_location_taipei) <- c("地區","camera_number")
##學校
school[grepl('中崙高中',school_name)]$address <- "臺北市松山區八德路四段101號"
school$地區 <- substr(school$address , start = 4 , stop = 6)
school$地區 <- iconv(school$地區,"big5","utf-8")
school_total <- school[,.N,by = "地區"]
colnames(school_total) <- c("地區","school_number")
#以學校層級分
school_byschool <- school[,.N,by = school]
colnames(school_byschool) <- c("school","school_number")
##資料結合
##merge3 有台北市各區域總人口、男生人口數、女生人口數、汽車發生偷竊次數、自行車發生偷竊次數、警察局總數
merge1 <- full_join(people_taipei_area,cartotal,by="地區")
merge2 <- full_join(merge1,biketotal,by="地區")
merge3 <- full_join(merge2,policetotal,by="地區")
merge4 <- full_join(merge3,land_taipei_need,by="地區")
merge5 <- merge(merge4,freq_location_taipei,by="地區")
merge6 <- full_join(merge5,school_total,by="地區")
View(school_total)
View(school_byschool)
#install.packages("data.table")
library(data.table)
car <- fread("~/Desktop/R Final/txt/car.txt" ,colClasses = "character")
bike <- fread("~/Desktop/R Final/txt/bike.txt" ,colClasses = "character")
police <- fread("~/Desktop/R Final/txt/police.txt" ,colClasses = "character")
people <- fread("~/Desktop/R Final/opendata10512M030.csv",colClasses = "character" , skip = 1)
land <- fread("~/Desktop/R Final/opendata105N010.csv",colClasses = "character" , skip = 1)
camera <- fread("~/Desktop/R Final/1041008.csv",colClasses = "character")
school <- fread("~/Desktop/R Final/txt/1050113臺北市各級學校分布圖%2528含國小_國中_高中職_特教學校_市立大學%25291030730+%281%29.txt",colClasses = "character")
library(dplyr)
##人口表
##people_taipei 只有台北市的人口資料
##people_taipei_area 台北市各區域的總人口，男生人口，女生人口
people_taipei <- people[grepl("臺北市",people$區域別),]
people_taipei_area <- group_by(people_taipei,區域別) %>% summarise(people_total = sum(as.numeric(人口數)) , people_man = sum(as.numeric(`人口數-男`)) , people_woman = sum(as.numeric(`人口數-女`)))
people_taipei_area$地區 <- substr(people_taipei_area$區域別 , start = 4 , stop = 6)
##汽車偷竊
##cartotal 台北市各區域汽車偷竊次數
car$地區 <- substr(car$`發生(現)地點`,start = 4,stop = 6)
cartotal <- group_by(car,地區) %>% summarise(carnumber = n()) #地區&時段
##自行車偷竊
##biketotal 台北市各區域自行車偷竊次數
bike$地區 <- substr(bike$`發生(現)地點` , start = 4 , stop = 6)
biketotal <- group_by(bike,地區) %>% summarise(bikenumber = n())
##警察局
##台北市各區域警察局總數
police$地區 <- substr(police$poi_addr , start = 4 , stop = 6)
policetotal <-  group_by(police,地區) %>% summarise(policenumber = n())
##人口密度
##land_taipei 臺北市資料
land_taipei <- land[grepl("臺北市",land$區域別),]
land_taipei$地區 <- substr(land_taipei$區域別 , start = 4 , stop = 6)
land_taipei_need <-land_taipei[,c(5,6)]
##監視器
##
camera_need <- camera[,c(3,5)]
camera_need$precinct <- substr(camera_need$precinct , start = 1 , stop = 2)
camera_need$地區 <- ifelse(camera_need$precinct=="",yes="",no = paste0(camera_need$precinct,"區"))
camera_need <- camera_need[!precinct==""]
freq_location_taipei<-camera_need[,.N,by = 地區]
colnames(freq_location_taipei) <- c("地區","camera_number")
##學校
school[grepl('中崙高中',school_name)]$address <- "臺北市松山區八德路四段101號"
school$地區 <- substr(school$address , start = 4 , stop = 6)
school[grepl('中崙高中',school_name)]$address <- iconv(school[grepl('中崙高中',school_name)]$address,"big5","utf-8")
school_total <- school[,.N,by = "地區"]
colnames(school_total) <- c("地區","school_number")
#以學校層級分
school_byschool <- school[,.N,by = school]
colnames(school_byschool) <- c("school","school_number")
##資料結合
##merge3 有台北市各區域總人口、男生人口數、女生人口數、汽車發生偷竊次數、自行車發生偷竊次數、警察局總數
merge1 <- full_join(people_taipei_area,cartotal,by="地區")
merge2 <- full_join(merge1,biketotal,by="地區")
merge3 <- full_join(merge2,policetotal,by="地區")
merge4 <- full_join(merge3,land_taipei_need,by="地區")
merge5 <- merge(merge4,freq_location_taipei,by="地區")
merge6 <- full_join(merge5,school_total,by="地區")
View(school_total)
View(school_byschool)
library(dplyr)
##人口表
##people_taipei 只有台北市的人口資料
##people_taipei_area 台北市各區域的總人口，男生人口，女生人口
people_taipei <- people[grepl("臺北市",people$區域別),]
people_taipei_area <- group_by(people_taipei,區域別) %>% summarise(people_total = sum(as.numeric(人口數)) , people_man = sum(as.numeric(`人口數-男`)) , people_woman = sum(as.numeric(`人口數-女`)))
people_taipei_area$地區 <- substr(people_taipei_area$區域別 , start = 4 , stop = 6)
##汽車偷竊
##cartotal 台北市各區域汽車偷竊次數
car$地區 <- substr(car$`發生(現)地點`,start = 4,stop = 6)
cartotal <- group_by(car,地區) %>% summarise(carnumber = n()) #地區&時段
##自行車偷竊
##biketotal 台北市各區域自行車偷竊次數
bike$地區 <- substr(bike$`發生(現)地點` , start = 4 , stop = 6)
biketotal <- group_by(bike,地區) %>% summarise(bikenumber = n())
##警察局
##台北市各區域警察局總數
police$地區 <- substr(police$poi_addr , start = 4 , stop = 6)
policetotal <-  group_by(police,地區) %>% summarise(policenumber = n())
##人口密度
##land_taipei 臺北市資料
land_taipei <- land[grepl("臺北市",land$區域別),]
land_taipei$地區 <- substr(land_taipei$區域別 , start = 4 , stop = 6)
land_taipei_need <-land_taipei[,c(5,6)]
##監視器
##
camera_need <- camera[,c(3,5)]
camera_need$precinct <- substr(camera_need$precinct , start = 1 , stop = 2)
camera_need$地區 <- ifelse(camera_need$precinct=="",yes="",no = paste0(camera_need$precinct,"區"))
camera_need <- camera_need[!precinct==""]
freq_location_taipei<-camera_need[,.N,by = 地區]
colnames(freq_location_taipei) <- c("地區","camera_number")
##學校
school[grepl('中崙高中',school_name)]$address <- "臺北市松山區八德路四段101號"
school[grepl('中崙高中',school_name)]$address <- iconv(school[grepl('中崙高中',school_name)]$address,"big5","utf-8")
school$地區 <- substr(school$address , start = 4 , stop = 6)
school_total <- school[,.N,by = "地區"]
colnames(school_total) <- c("地區","school_number")
#以學校層級分
school_byschool <- school[,.N,by = school]
colnames(school_byschool) <- c("school","school_number")
##資料結合
##merge3 有台北市各區域總人口、男生人口數、女生人口數、汽車發生偷竊次數、自行車發生偷竊次數、警察局總數
merge1 <- full_join(people_taipei_area,cartotal,by="地區")
merge2 <- full_join(merge1,biketotal,by="地區")
merge3 <- full_join(merge2,policetotal,by="地區")
merge4 <- full_join(merge3,land_taipei_need,by="地區")
merge5 <- merge(merge4,freq_location_taipei,by="地區")
merge6 <- full_join(merge5,school_total,by="地區")
View(school_total)
library(dplyr)
##人口表
##people_taipei 只有台北市的人口資料
##people_taipei_area 台北市各區域的總人口，男生人口，女生人口
people_taipei <- people[grepl("臺北市",people$區域別),]
people_taipei_area <- group_by(people_taipei,區域別) %>% summarise(people_total = sum(as.numeric(人口數)) , people_man = sum(as.numeric(`人口數-男`)) , people_woman = sum(as.numeric(`人口數-女`)))
people_taipei_area$地區 <- substr(people_taipei_area$區域別 , start = 4 , stop = 6)
##汽車偷竊
##cartotal 台北市各區域汽車偷竊次數
car$地區 <- substr(car$`發生(現)地點`,start = 4,stop = 6)
cartotal <- group_by(car,地區) %>% summarise(carnumber = n()) #地區&時段
##自行車偷竊
##biketotal 台北市各區域自行車偷竊次數
bike$地區 <- substr(bike$`發生(現)地點` , start = 4 , stop = 6)
biketotal <- group_by(bike,地區) %>% summarise(bikenumber = n())
##警察局
##台北市各區域警察局總數
police$地區 <- substr(police$poi_addr , start = 4 , stop = 6)
policetotal <-  group_by(police,地區) %>% summarise(policenumber = n())
##人口密度
##land_taipei 臺北市資料
land_taipei <- land[grepl("臺北市",land$區域別),]
land_taipei$地區 <- substr(land_taipei$區域別 , start = 4 , stop = 6)
land_taipei_need <-land_taipei[,c(5,6)]
##監視器
##
camera_need <- camera[,c(3,5)]
camera_need$precinct <- substr(camera_need$precinct , start = 1 , stop = 2)
camera_need$地區 <- ifelse(camera_need$precinct=="",yes="",no = paste0(camera_need$precinct,"區"))
camera_need <- camera_need[!precinct==""]
freq_location_taipei<-camera_need[,.N,by = 地區]
colnames(freq_location_taipei) <- c("地區","camera_number")
##學校
school[grepl('中崙高中',school_name)]$address <- "臺北市松山區八德路四段101號"
school[grepl('中崙高中',school_name)]$address <- iconv(school[grepl('中崙高中',school_name)]$address,"utf-8","utf-8")
school$地區 <- substr(school$address , start = 4 , stop = 6)
school_total <- school[,.N,by = "地區"]
colnames(school_total) <- c("地區","school_number")
#以學校層級分
school_byschool <- school[,.N,by = school]
colnames(school_byschool) <- c("school","school_number")
##資料結合
##merge3 有台北市各區域總人口、男生人口數、女生人口數、汽車發生偷竊次數、自行車發生偷竊次數、警察局總數
merge1 <- full_join(people_taipei_area,cartotal,by="地區")
merge2 <- full_join(merge1,biketotal,by="地區")
merge3 <- full_join(merge2,policetotal,by="地區")
merge4 <- full_join(merge3,land_taipei_need,by="地區")
merge5 <- merge(merge4,freq_location_taipei,by="地區")
merge6 <- full_join(merge5,school_total,by="地區")
View(school_total)
View(merge6)
install.packages("showtext")
View(merge6)
#install.packages("data.table")
library(data.table)
car <- fread("~/Desktop/R Final/txt/car.txt" ,colClasses = "character")
library(dplyr)
##人口表
##people_taipei 只有台北市的人口資料
##people_taipei_area 台北市各區域的總人口，男生人口，女生人口
people_taipei <- people[grepl("臺北市",people$區域別),]
people_taipei_area <- group_by(people_taipei,區域別) %>% summarise(people_total = sum(as.numeric(人口數)) , people_man = sum(as.numeric(`人口數-男`)) , people_woman = sum(as.numeric(`人口數-女`)))
people_taipei_area$地區 <- substr(people_taipei_area$區域別 , start = 4 , stop = 6)
##汽車偷竊
##cartotal 台北市各區域汽車偷竊次數
car$地區 <- substr(car$`發生(現)地點`,start = 4,stop = 6)
cartotal <- group_by(car,地區) %>% summarise(carnumber = n()) #地區&時段
##自行車偷竊
##biketotal 台北市各區域自行車偷竊次數
bike$地區 <- substr(bike$`發生(現)地點` , start = 4 , stop = 6)
biketotal <- group_by(bike,地區) %>% summarise(bikenumber = n())
##警察局
##台北市各區域警察局總數
police$地區 <- substr(police$poi_addr , start = 4 , stop = 6)
policetotal <-  group_by(police,地區) %>% summarise(policenumber = n())
##人口密度
##land_taipei 臺北市資料
land_taipei <- land[grepl("臺北市",land$區域別),]
land_taipei$地區 <- substr(land_taipei$區域別 , start = 4 , stop = 6)
land_taipei_need <-land_taipei[,c(5,6)]
##監視器
##
camera_need <- camera[,c(3,5)]
camera_need$precinct <- substr(camera_need$precinct , start = 1 , stop = 2)
camera_need$地區 <- ifelse(camera_need$precinct=="",yes="",no = paste0(camera_need$precinct,"區"))
camera_need <- camera_need[!precinct==""]
freq_location_taipei<-camera_need[,.N,by = 地區]
colnames(freq_location_taipei) <- c("地區","camera_number")
##學校
school[grepl('中崙高中',school_name)]$address <- "臺北市松山區八德路四段101號"
school[grepl('中崙高中',school_name)]$address <- iconv(school[grepl('中崙高中',school_name)]$address,"utf-8","utf-8")
school$地區 <- substr(school$address , start = 4 , stop = 6)
school_total <- school[,.N,by = "地區"]
colnames(school_total) <- c("地區","school_number")
#以學校層級分
school_byschool <- school[,.N,by = school]
colnames(school_byschool) <- c("school","school_number")
##資料結合
##merge3 有台北市各區域總人口、男生人口數、女生人口數、汽車發生偷竊次數、自行車發生偷竊次數、警察局總數
merge1 <- full_join(people_taipei_area,cartotal,by="地區")
merge2 <- full_join(merge1,biketotal,by="地區")
merge3 <- full_join(merge2,policetotal,by="地區")
merge4 <- full_join(merge3,land_taipei_need,by="地區")
merge5 <- merge(merge4,freq_location_taipei,by="地區")
merge6 <- full_join(merge5,school_total,by="地區")
#這是R Code Chunk
# install.packages("showtext")
library(dplyr)
library(showtext)
install.packages("showtext")
#這是R Code Chunk
# install.packages("showtext")
library(dplyr)
library(showtext)
install.packages("sysfonts")
#這是R Code Chunk
# install.packages("showtext")
library(dplyr)
library(showtext)
install.packages("showtext")
#這是R Code Chunk
# install.packages("showtext")
library(dplyr)
library(showtext)
#這是R Code Chunk
# install.packages("showtext")
library(dplyr)
showtext.auto(enable = TRUE)
#這是R Code Chunk
# install.packages("showtext")
library(dplyr)
##library(showtext)
##showtext.auto(enable = TRUE)
library(ggplot2)
merge3<-mutate(merge3, "竊盗總數"=carnumber+bikenumber)
summary(merge3$bikenumber)
hist.bike<-merge3$bikenumber
names(hist.bike)<-merge3$地區
summary(merge3$carnumber)
hist.car<-merge3$carnumber
names(hist.car)<-merge3$地區
x.par <- par(mfrow = c(1,2))
barplot(hist.car, xlab = "區域別", ylab = "次數", main ="車在各區被竊盗的次數",density=5)
barplot(hist.bike, xlab = "區域別", ylab = "次數", main ="自行車在各區被竊盗的次數",density=5, ylim=c(0, 140))
par(x.par)
#車被竊盗的量比自行車的量高出很多
shapiro.test(merge3$竊盗總數)
#不服從常態分配
cor(merge3$竊盗總數, merge3$policenumber)
#各區警察局的數量與竊盗總數的相關係數皆趨近於零，線性關係很底。
cov(merge3$竊盗總數, merge3$policenumber)
#各區警察局的數量與竊盗總數的共變異數的絕對值皆<2,線性關係很弱。
steal.car<- rbind(car,bike)
steal.car1<-steal.car[,c(2,4,6)]
steal.car1<- group_by(steal.car1, 地區)%>%
mutate("竊盗總數"= n())
steal.car2<- steal.car1[!duplicated(steal.car1[, c("發生時段", "地區", "案類")]),]
steal.car2 <- full_join(steal.car2,policetotal,by="地區") %>%
full_join(people_taipei_area[, c(2,5)],by="地區")
#取得各區在某時段的竊盗總數、總人口數、警察局數
#-------------------------------
steal.car3 <- full_join(steal.car2, merge6[,c('地區','人口密度')], by="地區") %>%
full_join(merge6[,c('地區','camera_number')], by="地區") %>%
full_join(merge6[,c('地區','school_number')], by="地區")
qplot(竊盗總數, camera_number, data = steal.car3, main="各區域竊盜事件數與監視器相關性",xlab = "竊盜事件數", ylab = "監視器數量")
qplot(竊盗總數, school_number, data = steal.car3, main="各區域竊盜事件數與學校數相關性",xlab = "竊盜事件數", ylab = "學校數量")
qplot(竊盗總數, 人口密度, data = steal.car3, main="各區域竊盜事件數與人口密度相關性",xlab = "竊盜事件數", ylab = "人口密度")
cor(steal.car3$竊盗總數, as.numeric(steal.car3$人口密度)) #獨立
cov(steal.car3$竊盗總數, as.numeric(steal.car3$人口密度)) #正相關
cor(steal.car3$竊盗總數, steal.car3$camera_number) #　0.39
cov(steal.car3$竊盗總數, steal.car3$camera_number) #正相關
cor(steal.car3$竊盗總數, steal.car3$school_number) #  0.41
cov(steal.car3$竊盗總數, steal.car3$school_number) #正相關
#-------------------------------
qplot(竊盗總數, policenumber, data = steal.car2, main="各區域竊盜事件數與警察局的分佈相關性",xlab = "竊盜事件數", ylab = "警察局數量", color = 發生時段)
#+theme(text=element_text(family = "HanziPen TC Regular", size=12))
qplot(竊盗總數, people_total, data = steal.car2, main="各區域竊盜事件數與總人口數相關性",xlab = "竊盜事件數", ylab = "總人口數", color = 發生時段)
#+theme(text=element_text(family = "HanziPen TC Regular", size=12))
#可見人口與警察局的多寡不防礙竊盜的發生，竊盗發生的時間沒有集中的趨勢
qplot(地區, data = steal.car, main="各區域竊盜事件數")
#+theme(text=element_text(family = "HanziPen TC Regular", size=12))
# 大安區與北投區發生竊盗事件最高。
#這是R Code Chunk
# install.packages("showtext")
library(dplyr)
##library(showtext)
##showtext.auto(enable = TRUE)
library(ggplot2)
merge3<-mutate(merge3, "竊盗總數"=carnumber+bikenumber)
summary(merge3$bikenumber)
hist.bike<-merge3$bikenumber
names(hist.bike)<-merge3$地區
summary(merge3$carnumber)
hist.car<-merge3$carnumber
names(hist.car)<-merge3$地區
x.par <- par(mfrow = c(1,2))
barplot(hist.car, xlab = "區域別", ylab = "次數", main ="車在各區被竊盗的次數",density=5)
barplot(hist.bike, xlab = "區域別", ylab = "次數", main ="自行車在各區被竊盗的次數",density=5, ylim=c(0, 140))
par(x.par)
#車被竊盗的量比自行車的量高出很多
shapiro.test(merge3$竊盗總數)
#不服從常態分配
cor(merge3$竊盗總數, merge3$policenumber)
#各區警察局的數量與竊盗總數的相關係數皆趨近於零，線性關係很底。
cov(merge3$竊盗總數, merge3$policenumber)
#各區警察局的數量與竊盗總數的共變異數的絕對值皆<2,線性關係很弱。
steal.car<- rbind(car,bike)
steal.car1<-steal.car[,c(2,4,6)]
steal.car1<- group_by(steal.car1, 地區)%>%
mutate("竊盗總數"= n())
steal.car2<- steal.car1[!duplicated(steal.car1[, c("發生時段", "地區", "案類")]),]
steal.car2 <- full_join(steal.car2,policetotal,by="地區") %>%
full_join(people_taipei_area[, c(2,5)],by="地區")
#取得各區在某時段的竊盗總數、總人口數、警察局數
#-------------------------------
steal.car3 <- full_join(steal.car2, merge6[,c('地區','人口密度')], by="地區") %>%
full_join(merge6[,c('地區','camera_number')], by="地區") %>%
full_join(merge6[,c('地區','school_number')], by="地區")
qplot(竊盗總數, camera_number, data = steal.car3, main="各區域竊盜事件數與監視器相關性",xlab = "竊盜事件數", ylab = "監視器數量")
qplot(竊盗總數, school_number, data = steal.car3, main="各區域竊盜事件數與學校數相關性",xlab = "竊盜事件數", ylab = "學校數量")
qplot(竊盗總數, 人口密度, data = steal.car3, main="各區域竊盜事件數與人口密度相關性",xlab = "竊盜事件數", ylab = "人口密度")
cor(steal.car3$竊盗總數, as.numeric(steal.car3$人口密度)) #獨立
cov(steal.car3$竊盗總數, as.numeric(steal.car3$人口密度)) #正相關
cor(steal.car3$竊盗總數, steal.car3$camera_number) #　0.39
cov(steal.car3$竊盗總數, steal.car3$camera_number) #正相關
cor(steal.car3$竊盗總數, steal.car3$school_number) #  0.41
cov(steal.car3$竊盗總數, steal.car3$school_number) #正相關
#-------------------------------
qplot(竊盗總數, policenumber, data = steal.car2, main="各區域竊盜事件數與警察局的分佈相關性",xlab = "竊盜事件數", ylab = "警察局數量", color = 發生時段)
#+theme(text=element_text(family = "HanziPen TC Regular", size=12))
qplot(竊盗總數, people_total, data = steal.car2, main="各區域竊盜事件數與總人口數相關性",xlab = "竊盜事件數", ylab = "總人口數", color = 發生時段)
#+theme(text=element_text(family = "HanziPen TC Regular", size=12))
#可見人口與警察局的多寡不防礙竊盜的發生，竊盗發生的時間沒有集中的趨勢
qplot(地區, data = steal.car, main="各區域竊盜事件數")
#+theme(text=element_text(family = "HanziPen TC Regular", size=12))
# 大安區與北投區發生竊盗事件最高。
merge6_1 <- merge6[,c(3:11)]
library(corrplot)
M <- cor(merge6_1,method="kendall")
#這是R Code Chunk
# install.packages("showtext")
library(dplyr)
##library(showtext)
##showtext.auto(enable = TRUE)
library(ggplot2)
merge3<-mutate(merge3, "竊盗總數"=carnumber+bikenumber)
summary(merge3$bikenumber)
hist.bike<-merge3$bikenumber
names(hist.bike)<-merge3$地區
summary(merge3$carnumber)
hist.car<-merge3$carnumber
names(hist.car)<-merge3$地區
x.par <- par(mfrow = c(1,2))
barplot(hist.car, xlab = "區域別", ylab = "次數", main ="車在各區被竊盗的次數",density=5)
barplot(hist.bike, xlab = "區域別", ylab = "次數", main ="自行車在各區被竊盗的次數",density=5, ylim=c(0, 140))
par(x.par)
#車被竊盗的量比自行車的量高出很多
shapiro.test(merge3$竊盗總數)
#不服從常態分配
cor(merge3$竊盗總數, merge3$policenumber)
#各區警察局的數量與竊盗總數的相關係數皆趨近於零，線性關係很底。
cov(merge3$竊盗總數, merge3$policenumber)
#各區警察局的數量與竊盗總數的共變異數的絕對值皆<2,線性關係很弱。
steal.car<- rbind(car,bike)
steal.car1<-steal.car[,c(2,4,6)]
steal.car1<- group_by(steal.car1, 地區)%>%
mutate("竊盗總數"= n())
steal.car2<- steal.car1[!duplicated(steal.car1[, c("發生時段", "地區", "案類")]),]
steal.car2 <- full_join(steal.car2,policetotal,by="地區") %>%
full_join(people_taipei_area[, c(2,5)],by="地區")
#取得各區在某時段的竊盗總數、總人口數、警察局數
#-------------------------------
steal.car3 <- full_join(steal.car2, merge6[,c('地區','人口密度')], by="地區") %>%
full_join(merge6[,c('地區','camera_number')], by="地區") %>%
full_join(merge6[,c('地區','school_number')], by="地區")
qplot(竊盗總數, camera_number, data = steal.car3, main="各區域竊盜事件數與監視器相關性",xlab = "竊盜事件數", ylab = "監視器數量")
qplot(竊盗總數, school_number, data = steal.car3, main="各區域竊盜事件數與學校數相關性",xlab = "竊盜事件數", ylab = "學校數量")
qplot(竊盗總數, 人口密度, data = steal.car3, main="各區域竊盜事件數與人口密度相關性",xlab = "竊盜事件數", ylab = "人口密度")
cor(steal.car3$竊盗總數, as.numeric(steal.car3$人口密度)) #獨立
cov(steal.car3$竊盗總數, as.numeric(steal.car3$人口密度)) #正相關
cor(steal.car3$竊盗總數, steal.car3$camera_number) #　0.39
cov(steal.car3$竊盗總數, steal.car3$camera_number) #正相關
cor(steal.car3$竊盗總數, steal.car3$school_number) #  0.41
cov(steal.car3$竊盗總數, steal.car3$school_number) #正相關
#-------------------------------
qplot(竊盗總數, policenumber, data = steal.car2, main="各區域竊盜事件數與警察局的分佈相關性",xlab = "竊盜事件數", ylab = "警察局數量", color = 發生時段)
#+theme(text=element_text(family = "HanziPen TC Regular", size=12))
qplot(竊盗總數, people_total, data = steal.car2, main="各區域竊盜事件數與總人口數相關性",xlab = "竊盜事件數", ylab = "總人口數", color = 發生時段)
#+theme(text=element_text(family = "HanziPen TC Regular", size=12))
#可見人口與警察局的多寡不防礙竊盜的發生，竊盗發生的時間沒有集中的趨勢
qplot(地區, data = steal.car, main="各區域竊盜事件數")
#+theme(text=element_text(family = "HanziPen TC Regular", size=12))
# 大安區與北投區發生竊盗事件最高。
merge6_1 <- merge6[,as.numeric(c(3:11))]
library(corrplot)
M <- cor(merge6_1,method="kendall")
merge6_1$carnumber <- as.numeric(merge6_1$carnumber)
merge6_1 <- merge6[,as.numeric(c(3:11))]
merge6_1$carnumber <- as.numeric(merge6_1$carnumber)
merge6_1$bikenumber <- as.numeric(merge6_1$bikenumber)
merge6_1$policenumber <- as.numeric(merge6_1$policenumber)
merge6_1$人口密度 <- as.numeric(merge6_1$人口密度)
merge6_1$camera_number <- as.numeric(merge6_1$camera_number)
merge6_1$school_number <- as.numeric(merge6_1$school_number)
merge6_1 <- merge6[,(3:11)]
merge6_1$carnumber <- as.numeric(merge6_1$carnumber)
merge6_1$bikenumber <- as.numeric(merge6_1$bikenumber)
merge6_1$policenumber <- as.numeric(merge6_1$policenumber)
merge6_1$人口密度 <- as.numeric(merge6_1$人口密度)
merge6_1$camera_number <- as.numeric(merge6_1$camera_number)
merge6_1$school_number <- as.numeric(merge6_1$school_number)
library(corrplot)
M <- cor(merge6_1,method="kendall")
cor_properties <- corrplot(M, method = 'number',order ="hclust", tl.col="black", tl.cex = 1, tl.offset = 1, tl.srt = 40)
#install.packages("data.table")
library(data.table)
car <- fread("~/Documents/GitHub/CGUIM_BigData_HW6-heymei/R Final/txt/car.txt" ,colClasses = "character")
bike <- fread("~/Documents/GitHub/CGUIM_BigData_HW6-heymei/R Final/txt/bike.txt" ,colClasses = "character")
police <- fread("~/Documents/GitHub/CGUIM_BigData_HW6-heymei/R Final/txt/police.txt" ,colClasses = "character")
people <- fread("~/Documents/GitHub/CGUIM_BigData_HW6-heymei/R Final/opendata10512M030.csv",colClasses = "character" , skip = 1)
land <- fread("~/Documents/GitHub/CGUIM_BigData_HW6-heymei/R Final/opendata105N010.csv",colClasses = "character" , skip = 1)
camera <- fread("~/Documents/GitHub/CGUIM_BigData_HW6-heymei/R Final/1041008.csv",colClasses = "character")
school <- fread("~/Documents/GitHub/CGUIM_BigData_HW6-heymei/R Final/txt/1050113臺北市各級學校分布圖%2528含國小_國中_高中職_特教學校_市立大學%25291030730+%281%29.txt",colClasses = "character")
#install.packages("data.table")
library(data.table)
car <- fread("~/Documents/GitHub/CGUIM_BigData_HW6-heymei/R Final/txt/car.txt" ,colClasses = "character")
bike <- fread("~/Documents/GitHub/CGUIM_BigData_HW6-heymei/R Final/txt/bike.txt" ,colClasses = "character")
police <- fread("~/Documents/GitHub/CGUIM_BigData_HW6-heymei/R Final/txt/police.txt" ,colClasses = "character")
people <- fread("~/Documents/GitHub/CGUIM_BigData_HW6-heymei/R Final/opendata10512M030.csv",colClasses = "character" , skip = 1)
land <- fread("~/Documents/GitHub/CGUIM_BigData_HW6-heymei/R Final/opendata105N010.csv",colClasses = "character" , skip = 1)
camera <- fread("~/Documents/GitHub/CGUIM_BigData_HW6-heymei/R Final/1041008.csv",colClasses = "character")
school <- fread("~/Documents/GitHub/CGUIM_BigData_HW6-heymei/R Final/txt/1050113臺北市各級學校分布圖%2528含國小_國中_高中職_特教學校_市立大學%25291030730+%281%29.txt",colClasses = "character")
View(car)
library(dplyr)
##人口表
##people_taipei 只有台北市的人口資料
##people_taipei_area 台北市各區域的總人口，男生人口，女生人口
people_taipei <- people[grepl("臺北市",people$區域別),]
people_taipei_area <- group_by(people_taipei,區域別) %>% summarise(people_total = sum(as.numeric(人口數)) , people_man = sum(as.numeric(`人口數-男`)) , people_woman = sum(as.numeric(`人口數-女`)))
people_taipei_area$地區 <- substr(people_taipei_area$區域別 , start = 4 , stop = 6)
View(people_taipei_area)
##汽車偷竊
##cartotal 台北市各區域汽車偷竊次數
car$地區 <- substr(car$`發生(現)地點`,start = 4,stop = 6)
cartotal <- group_by(car,地區) %>% summarise(carnumber = n()) #地區&時段
View(cartotal)
install.packages("mptools")
library(maptools)
library(maptools)
install.packages('mptools')
library(maptools)
install.packages('maptools')
library(maptools)
area <- readShapePoly("~/Documents/GitHub/CGUIM_BigData_HW6-heymei/R Final/CCTV/CCTV.shp")
install.packages('maptools')
install.packages("maptools")
library(maptools)
area <- readShapePoly("~/Documents/GitHub/CGUIM_BigData_HW6-heymei/R Final/CCTV/CCTV.shp")
area <- readShapeSpatial("~/Documents/GitHub/CGUIM_BigData_HW6-heymei/R Final/CCTV/CCTV.shp")
install.packages('sf')
library(sf)
area <- readShapeSpatial("~/Documents/GitHub/CGUIM_BigData_HW6-heymei/R Final/CCTV/CCTV.shp")
area <- sf::st_read("~/Documents/GitHub/CGUIM_BigData_HW6-heymei/R Final/CCTV/CCTV.shp")
install.packages("rgdal")
install.packages('maptools')
install.packages("maptools")
library(rgdal)
area <- rgdal::readOGR("~/Documents/GitHub/CGUIM_BigData_HW6-heymei/R Final/CCTV/CCTV.shp")
abcde <- fread("~/Downloads/安哥測試.csv")
abcde <- fread("~/Downloads/安哥測試.xlsx")
abcde <- fread("~/Desktop/安哥測試.csv")
M <- cor(abcde,method="kendall")
abcde <- fread("~/Downloads/安哥測試(2).xlsx")
abcde <- fread("~/Downloads/安哥測試 (2).xlsx")
abcde <- fread("~/Desktop/安哥測試 (2).csv")
M <- cor(abcde,method="kendall")
cor_properties <- corrplot(M, method = 'number',order ="hclust", tl.col="black", tl.cex = 1, tl.offset = 1, tl.srt = 40)
abcde <- fread("~/Desktop/安哥測試 (3).csv")
M <- cor(abcde,method="kendall")
cor_properties <- corrplot(M, method = 'number',order ="hclust", tl.col="black", tl.cex = 1, tl.offset = 1, tl.srt = 40)
area <- readShapePoly("~/Documents/GitHub/CGUIM_BigData_HW6-heymei/R Final/CCTV/CCTV.shp")
