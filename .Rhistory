cor(steal.car3$竊盗總數, as.numeric(steal.car3$人口密度)) #獨立
cov(steal.car3$竊盗總數, as.numeric(steal.car3$人口密度)) #正相關
cor(steal.car3$竊盗總數, steal.car3$camera_number) #　0.39
cov(steal.car3$竊盗總數, steal.car3$camera_number) #正相關
cor(steal.car3$竊盗總數, steal.car3$school_number) #  0.41
cov(steal.car3$竊盗總數, steal.car3$school_number) #正相關
#-------------------------------
qplot(竊盗總數, policenumber, data = steal.car2, main="各區域竊盜事件數與警察局的分佈相關性",xlab = "竊盜事件數", ylab = "警察局數量", color = 發生時段)
#+theme(text=element_text(family = "HanziPen TC Regular", size=12))
qplot(竊盗總數, people_total, data = steal.car2, main="各區域竊盜事件數與總人口數相關性",xlab = "竊盜事件數", ylab = "總人口數", color = 發生時段)
#+theme(text=element_text(family = "HanziPen TC Regular", size=12))
#可見人口與警察局的多寡不防礙竊盜的發生，竊盗發生的時間沒有集中的趨勢
qplot(地區, data = steal.car, main="各區域竊盜事件數")
#+theme(text=element_text(family = "HanziPen TC Regular", size=12))
# 大安區與北投區發生竊盗事件最高。
merge6_1 <- merge6[,(3:11)]
merge6_1$carnumber <- as.numeric(merge6_1$carnumber)
merge6_1$bikenumber <- as.numeric(merge6_1$bikenumber)
merge6_1$policenumber <- as.numeric(merge6_1$policenumber)
merge6_1$人口密度 <- as.numeric(merge6_1$人口密度)
merge6_1$camera_number <- as.numeric(merge6_1$camera_number)
merge6_1$school_number <- as.numeric(merge6_1$school_number)
library(corrplot)
M <- cor(merge6_1,method="kendall")
cor_properties <- corrplot(M, method = 'number',order ="hclust", tl.col="black", tl.cex = 1, tl.offset = 1, tl.srt = 40)
library(corrplot)
M <- cor(merge6_1,method="kendall")
cor_properties <- corrplot(M, method = 'number',order ="hclust", tl.col="black", tl.cex = 1, tl.offset = 1, tl.srt = 40)
#這是R Code Chunk
# install.packages("showtext")
library(dplyr)
##library(showtext)
##showtext.auto(enable = TRUE)
library(ggplot2)
merge3<-mutate(merge3, "竊盗總數"=carnumber+bikenumber)
summary(merge3$bikenumber)
hist.bike<-merge3$bikenumber
names(hist.bike)<-merge3$地區
summary(merge3$carnumber)
hist.car<-merge3$carnumber
names(hist.car)<-merge3$地區
x.par <- par(mfrow = c(1,2))
barplot(hist.car, xlab = "區域別", ylab = "次數", main ="車在各區被竊盗的次數",density=5)
barplot(hist.bike, xlab = "區域別", ylab = "次數", main ="自行車在各區被竊盗的次數",density=5, ylim=c(0, 140))
par(x.par)
#車被竊盗的量比自行車的量高出很多
shapiro.test(merge3$竊盗總數)
#不服從常態分配
cor(merge3$竊盗總數, merge3$policenumber)
#各區警察局的數量與竊盗總數的相關係數皆趨近於零，線性關係很底。
cov(merge3$竊盗總數, merge3$policenumber)
#各區警察局的數量與竊盗總數的共變異數的絕對值皆<2,線性關係很弱。
steal.car<- rbind(car,bike)
steal.car1<-steal.car[,c(2,4,6)]
steal.car1<- group_by(steal.car1, 地區)%>%
mutate("竊盗總數"= n())
steal.car2<- steal.car1[!duplicated(steal.car1[, c("發生時段", "地區", "案類")]),]
steal.car2 <- full_join(steal.car2,policetotal,by="地區") %>%
full_join(people_taipei_area[, c(2,5)],by="地區")
#取得各區在某時段的竊盗總數、總人口數、警察局數
#-------------------------------
steal.car3 <- full_join(steal.car2, merge6[,c('地區','人口密度')], by="地區") %>%
full_join(merge6[,c('地區','camera_number')], by="地區") %>%
full_join(merge6[,c('地區','school_number')], by="地區")
qplot(竊盗總數, camera_number, data = steal.car3, main="各區域竊盜事件數與監視器相關性",xlab = "竊盜事件數", ylab = "監視器數量")
qplot(竊盗總數, school_number, data = steal.car3, main="各區域竊盜事件數與學校數相關性",xlab = "竊盜事件數", ylab = "學校數量")
qplot(竊盗總數, 人口密度, data = steal.car3, main="各區域竊盜事件數與人口密度相關性",xlab = "竊盜事件數", ylab = "人口密度")
cor(steal.car3$竊盗總數, as.numeric(steal.car3$人口密度)) #獨立
cov(steal.car3$竊盗總數, as.numeric(steal.car3$人口密度)) #正相關
cor(steal.car3$竊盗總數, steal.car3$camera_number) #　0.39
cov(steal.car3$竊盗總數, steal.car3$camera_number) #正相關
cor(steal.car3$竊盗總數, steal.car3$school_number) #  0.41
cov(steal.car3$竊盗總數, steal.car3$school_number) #正相關
#-------------------------------
qplot(竊盗總數, policenumber, data = steal.car2, main="各區域竊盜事件數與警察局的分佈相關性",xlab = "竊盜事件數", ylab = "警察局數量", color = 發生時段)
#+theme(text=element_text(family = "HanziPen TC Regular", size=12))
qplot(竊盗總數, people_total, data = steal.car2, main="各區域竊盜事件數與總人口數相關性",xlab = "竊盜事件數", ylab = "總人口數", color = 發生時段)
#+theme(text=element_text(family = "HanziPen TC Regular", size=12))
#可見人口與警察局的多寡不防礙竊盜的發生，竊盗發生的時間沒有集中的趨勢
qplot(地區, data = steal.car, main="各區域竊盜事件數")
#+theme(text=element_text(family = "HanziPen TC Regular", size=12))
# 大安區與北投區發生竊盗事件最高。
merge6_1 <- merge6[,(3:11)]
merge6_1$carnumber <- as.numeric(merge6_1$carnumber)
merge6_1$bikenumber <- as.numeric(merge6_1$bikenumber)
merge6_1$policenumber <- as.numeric(merge6_1$policenumber)
merge6_1$人口密度 <- as.numeric(merge6_1$人口密度)
merge6_1$camera_number <- as.numeric(merge6_1$camera_number)
merge6_1$school_number <- as.numeric(merge6_1$school_number)
library(corrplot)
M <- cor(merge6_1,method="kendall")
cor_properties <- corrplot(M, method = 'number',order ="hclust", tl.col="black", tl.cex = 1, tl.offset = 1, tl.srt = 40)
View(merge6)
system("defaults write org.R-project.R force.LANG zh_TW.UTF-8")
library(ggplot2)
library(rgdal)
library(rgeos)
library(maptools)
area <- readShapeSpatial("~/R/CGUIM_BigData_HW6-heymei/R Final/CCTV/CCTV.shp")
area.df <- fortify(area , region = "are")
system("defaults write org.R-project.R force.LANG en_US.UTF-8")
library(ggplot2)
library(rgdal)
library(rgeos)
library(maptools)
area <- readShapeSpatial("~/R/CGUIM_BigData_HW6-heymei/R Final/CCTV/CCTV.shp")
Sys.setlocale(category = "LC_ALL", locale = "cht")
Sys.setlocale(category = "LC_ALL", locale = "UTF-8")
area <- readShapeSpatial("~/R/CGUIM_BigData_HW6-heymei/R Final/CCTV/CCTV.shp")
Sys.setlocale(category = "LC_ALL", locale = "us")
Sys.setlocale(category = "LC_ALL", locale = "C")
area <- readShapeSpatial("~/R/CGUIM_BigData_HW6-heymei/R Final/CCTV/CCTV.shp")
Sys.setlocale(category = "LC_ALL", locale = "cht")
area <- readShapeSpatial("~/R/CGUIM_BigData_HW6-heymei/R Final/CCTV/CCTV.shp")
library(ggplot2)
library(rgdal)
library(rgeos)
library(maptools)
Sys.setlocale(category = "LC_ALL", locale = "cht")
install.packages("jsonlite")
install.packages("RCurl")
library(jsonlite)
library(RCurl)
WaterData<-fromJSON(getURL("http://data.taipei/opendata/datalist/apiAccess?scope=resourceAquire&rid=190796c8-7c56-42e0-8068-39242b8ec927"))
WaterDataFrame<-WaterData$result$results
WaterDataFrame$longitude<-as.numeric(WaterDataFrame$longitude)
WaterDataFrame$latitude<-as.numeric(WaterDataFrame$latitude)
WaterDataFrame$qua_cntu<-as.numeric(WaterDataFrame$qua_cntu)
WaterDataClean<-WaterDataFrame[WaterDataFrame$qua_cntu>=0,]
head(WaterDataClean)
library(ggmap)
TaipeiMap <- get_map(
location = c(121.43,24.93,121.62,25.19),
zoom = 11, maptype = 'roadmap')
TaipeiMapO <- ggmap(TaipeiMap)+
geom_point(data=area,
aes(x=area$E, y=area$N,size=3.5))+
scale_color_continuous(
low = "yellow",high = "red")+
guides(size=FALSE)
install.packages("ggmap")
library(ggmap)
TaipeiMap <- get_map(
location = c(121.43,24.93,121.62,25.19),
zoom = 11, maptype = 'roadmap')
TaipeiMapO <- ggmap(TaipeiMap)+
geom_point(data=area,
aes(x=area$E, y=area$N,size=3.5))+
scale_color_continuous(
low = "yellow",high = "red")+
guides(size=FALSE)
TaipeiMapO
install.packages("ggplot2")
library(ggmap)
TaipeiMap <- get_map(
location = c(121.43,24.93,121.62,25.19),
zoom = 11, maptype = 'roadmap')
TaipeiMapO <- ggmap(TaipeiMap)+
geom_point(data=area,
aes(x=area$E, y=area$N,size=3.5))+
scale_color_continuous(
low = "yellow",high = "red")+
guides(size=FALSE)
install.packages("ggmap")
library(ggmap)
TaipeiMap <- get_map(
location = c(121.43,24.93,121.62,25.19),
zoom = 11, maptype = 'roadmap')
TaipeiMapO <- ggmap(TaipeiMap)+
geom_point(data=area,
aes(x=area$E, y=area$N,size=3.5))+
scale_color_continuous(
low = "yellow",high = "red")+
guides(size=FALSE)
install.packages("ggmap", type = "source")
install.packages("ggmap", type = "source")
library(ggmap)
TaipeiMap <- get_map(
location = c(121.43,24.93,121.62,25.19),
zoom = 11, maptype = 'roadmap')
TaipeiMapO <- ggmap(TaipeiMap)+
geom_point(data=area,
aes(x=area$E, y=area$N,size=3.5))+
scale_color_continuous(
low = "yellow",high = "red")+
guides(size=FALSE)
TaipeiMapO
TaipeiMapO <- ggmap(TaipeiMap)+
geom_point(data=area,
aes(x=area$E, y=area$N,size=3.5))+
scale_color_continuous(
low = "yellow",high = "red")+
guides(size=FALSE)
TaipeiMapO <- ggmap(TaipeiMap)+
geom_point(data=area,
aes(x=area$E, y=area$N,size=3.5))+
scale_color_continuous(
low = "yellow",high = "red")+
guides(size=FALSE)
mydata <- data.frame(e = area$E , n = area$N)
View(mydata)
library(ggmap)
TaipeiMap <- get_map(
location = c(121.43,24.93,121.62,25.19),
zoom = 11, maptype = 'roadmap')
TaipeiMapO <- ggmap(TaipeiMap)+
geom_point(data=mydata,
aes(x=mydata$e, y=mydata$n,size=3.5))+
scale_color_continuous(
low = "yellow",high = "red")+
guides(size=FALSE)
TaipeiMapO
library(ggmap)
TaipeiMap <- get_map(
location = c(121.43,24.93,121.62,25.19),
zoom = 11, maptype = 'roadmap')
TaipeiMapO <- ggmap(TaipeiMap)+
geom_point(data=mydata,
aes(x=mydata$e, y=mydata$n,size=0.1))+
scale_color_continuous(
low = "yellow",high = "red")+
guides(size=FALSE)
TaipeiMapO
library(ggmap)
TaipeiMap <- get_map(
location = c(121.43,24.93,121.62,25.19),
zoom = 11, maptype = 'roadmap')
TaipeiMapO <- ggmap(TaipeiMap)+
geom_point(data=mydata,
aes(x=mydata$e, y=mydata$n,size=0.0001))+
scale_color_continuous(
low = "yellow",high = "red")+
guides(size=FALSE)
TaipeiMapO
library(ggmap)
TaipeiMap <- get_map(
location = c(121.43,24.93,121.62,25.19),
zoom = 16, maptype = 'roadmap')
TaipeiMapO <- ggmap(TaipeiMap)+
geom_point(data=mydata,
aes(x=mydata$e, y=mydata$n,size=0.0001))+
scale_color_continuous(
low = "yellow",high = "red")+
guides(size=FALSE)
TaipeiMapO
library(ggmap)
TaipeiMap <- get_map(
location = c(121.43,24.93,121.62,25.19),
zoom = 13, maptype = 'roadmap')
TaipeiMapO <- ggmap(TaipeiMap)+
geom_point(data=mydata,
aes(x=mydata$e, y=mydata$n,size=0.0001))+
scale_color_continuous(
low = "yellow",high = "red")+
guides(size=FALSE)
TaipeiMapO
library(jsonlite)
library(RCurl)
WaterData<-fromJSON(getURL("http://data.taipei/opendata/datalist/apiAccess?scope=resourceAquire&rid=190796c8-7c56-42e0-8068-39242b8ec927"))
WaterDataFrame<-WaterData$result$results
library(ggmap)
TaipeiMap <- get_map(
location = c(121.43,24.93,121.62,25.19),
zoom = 14, maptype = 'roadmap')
TaipeiMapO <- ggmap(TaipeiMap)+
geom_point(data=mydata,
aes(x=mydata$e, y=mydata$n,size=0.0001))+
scale_color_continuous(
low = "yellow",high = "red")+
guides(size=FALSE)
TaipeiMapO
View(camera)
library(dplyr)
##人口表
##people_taipei 只有台北市的人口資料
##people_taipei_area 台北市各區域的總人口，男生人口，女生人口
people_taipei <- people[grepl("臺北市",people$區域別),]
people_taipei_area <- group_by(people_taipei,區域別) %>% summarise(people_total = sum(as.numeric(人口數)) , people_man = sum(as.numeric(`人口數-男`)) , people_woman = sum(as.numeric(`人口數-女`)))
people_taipei_area$地區 <- substr(people_taipei_area$區域別 , start = 4 , stop = 6)
##汽車偷竊
##cartotal 台北市各區域汽車偷竊次數
car$地區 <- substr(car$`發生(現)地點`,start = 4,stop = 6)
cartotal <- group_by(car,地區) %>% summarise(carnumber = n()) #地區&時段
##自行車偷竊
##biketotal 台北市各區域自行車偷竊次數
bike$地區 <- substr(bike$`發生(現)地點` , start = 4 , stop = 6)
biketotal <- group_by(bike,地區) %>% summarise(bikenumber = n())
##警察局
##台北市各區域警察局總數
police$地區 <- substr(police$poi_addr , start = 4 , stop = 6)
policetotal <-  group_by(police,地區) %>% summarise(policenumber = n())
##人口密度
##land_taipei 臺北市資料
land_taipei <- land[grepl("臺北市",land$區域別),]
land_taipei$地區 <- substr(land_taipei$區域別 , start = 4 , stop = 6)
land_taipei_need <-land_taipei[,c(5,6)]
##監視器
##
camera_need <- camera[,c(3,5)]
camera_need$precinct <- substr(camera_need$precinct , start = 1 , stop = 2)
camera_need$地區 <- ifelse(camera_need$precinct=="",yes="",no = paste0(camera_need$precinct,"區"))
camera_need <- camera_need[!precinct==""]
library(dplyr)
##人口表
##people_taipei 只有台北市的人口資料
##people_taipei_area 台北市各區域的總人口，男生人口，女生人口
people_taipei <- people[grepl("臺北市",people$區域別),]
people_taipei_area <- group_by(people_taipei,區域別) %>% summarise(people_total = sum(as.numeric(人口數)) , people_man = sum(as.numeric(`人口數-男`)) , people_woman = sum(as.numeric(`人口數-女`)))
people_taipei_area$地區 <- substr(people_taipei_area$區域別 , start = 4 , stop = 6)
##汽車偷竊
##cartotal 台北市各區域汽車偷竊次數
car$地區 <- substr(car$`發生(現)地點`,start = 4,stop = 6)
cartotal <- group_by(car,地區) %>% summarise(carnumber = n()) #地區&時段
##自行車偷竊
##biketotal 台北市各區域自行車偷竊次數
bike$地區 <- substr(bike$`發生(現)地點` , start = 4 , stop = 6)
biketotal <- group_by(bike,地區) %>% summarise(bikenumber = n())
##警察局
##台北市各區域警察局總數
police$地區 <- substr(police$poi_addr , start = 4 , stop = 6)
policetotal <-  group_by(police,地區) %>% summarise(policenumber = n())
##人口密度
##land_taipei 臺北市資料
land_taipei <- land[grepl("臺北市",land$區域別),]
land_taipei$地區 <- substr(land_taipei$區域別 , start = 4 , stop = 6)
land_taipei_need <-land_taipei[,c(5,6)]
##監視器
##
camera_need <- camera[,c(3,5)]
camera_need$precinct <- substr(camera_need$precinct , start = 1 , stop = 2)
camera_need$地區 <- ifelse(camera_need$precinct=="",yes="",no = paste0(camera_need$precinct,"區"))
camera_need <- camera_need[!precinct==""]
#這是R Code Chunk
# install.packages("showtext")
library(dplyr)
##library(showtext)
##showtext.auto(enable = TRUE)
library(ggplot2)
merge3<-mutate(merge3, "竊盗總數"=carnumber+bikenumber)
summary(merge3$bikenumber)
hist.bike<-merge3$bikenumber
names(hist.bike)<-merge3$地區
summary(merge3$carnumber)
hist.car<-merge3$carnumber
names(hist.car)<-merge3$地區
x.par <- par(mfrow = c(1,2))
barplot(hist.car, xlab = "區域別", ylab = "次數", main ="車在各區被竊盗的次數",density=5)
barplot(hist.bike, xlab = "區域別", ylab = "次數", main ="自行車在各區被竊盗的次數",density=5, ylim=c(0, 140))
par(x.par)
#車被竊盗的量比自行車的量高出很多
shapiro.test(merge3$竊盗總數)
#不服從常態分配
cor(merge3$竊盗總數, merge3$policenumber)
#各區警察局的數量與竊盗總數的相關係數皆趨近於零，線性關係很底。
cov(merge3$竊盗總數, merge3$policenumber)
#各區警察局的數量與竊盗總數的共變異數的絕對值皆<2,線性關係很弱。
steal.car<- rbind(car,bike)
steal.car1<-steal.car[,c(2,4,6)]
steal.car1<- group_by(steal.car1, 地區)%>%
mutate("竊盗總數"= n())
steal.car2<- steal.car1[!duplicated(steal.car1[, c("發生時段", "地區", "案類")]),]
steal.car2 <- full_join(steal.car2,policetotal,by="地區") %>%
full_join(people_taipei_area[, c(2,5)],by="地區")
#取得各區在某時段的竊盗總數、總人口數、警察局數
#-------------------------------
steal.car3 <- full_join(steal.car2, merge6[,c('地區','人口密度')], by="地區") %>%
full_join(merge6[,c('地區','camera_number')], by="地區") %>%
full_join(merge6[,c('地區','school_number')], by="地區")
qplot(竊盗總數, camera_number, data = steal.car3, main="各區域竊盜事件數與監視器相關性",xlab = "竊盜事件數", ylab = "監視器數量")
qplot(竊盗總數, school_number, data = steal.car3, main="各區域竊盜事件數與學校數相關性",xlab = "竊盜事件數", ylab = "學校數量")
qplot(竊盗總數, 人口密度, data = steal.car3, main="各區域竊盜事件數與人口密度相關性",xlab = "竊盜事件數", ylab = "人口密度")
cor(steal.car3$竊盗總數, as.numeric(steal.car3$人口密度)) #獨立
cov(steal.car3$竊盗總數, as.numeric(steal.car3$人口密度)) #正相關
cor(steal.car3$竊盗總數, steal.car3$camera_number) #　0.39
cov(steal.car3$竊盗總數, steal.car3$camera_number) #正相關
cor(steal.car3$竊盗總數, steal.car3$school_number) #  0.41
cov(steal.car3$竊盗總數, steal.car3$school_number) #正相關
#-------------------------------
qplot(竊盗總數, policenumber, data = steal.car2, main="各區域竊盜事件數與警察局的分佈相關性",xlab = "竊盜事件數", ylab = "警察局數量", color = 發生時段)
+theme(text=element_text(family = "HanziPen TC Regular", size=12))
merge6_1 <- merge6[,(3:11)]
merge6_1$carnumber <- as.numeric(merge6_1$carnumber)
merge6_1$bikenumber <- as.numeric(merge6_1$bikenumber)
merge6_1$policenumber <- as.numeric(merge6_1$policenumber)
merge6_1$人口密度 <- as.numeric(merge6_1$人口密度)
merge6_1$camera_number <- as.numeric(merge6_1$camera_number)
merge6_1$school_number <- as.numeric(merge6_1$school_number)
library(corrplot)
M <- cor(merge6_1,method="kendall")
cor_properties <- corrplot(M, method = 'number',order ="hclust", tl.col="black", tl.cex = 1, tl.offset = 1, tl.srt = 40)
#這是R Code Chunk
# install.packages("showtext")
library(dplyr)
##library(showtext)
##showtext.auto(enable = TRUE)
library(ggplot2)
merge3<-mutate(merge3, "竊盗總數"=carnumber+bikenumber)
summary(merge3$bikenumber)
hist.bike<-merge3$bikenumber
names(hist.bike)<-merge3$地區
summary(merge3$carnumber)
hist.car<-merge3$carnumber
names(hist.car)<-merge3$地區
x.par <- par(mfrow = c(1,2))
barplot(hist.car, xlab = "區域別", ylab = "次數", main ="車在各區被竊盗的次數",density=5)
barplot(hist.bike, xlab = "區域別", ylab = "次數", main ="自行車在各區被竊盗的次數",density=5, ylim=c(0, 140))
par(x.par)
#車被竊盗的量比自行車的量高出很多
shapiro.test(merge3$竊盗總數)
#不服從常態分配
cor(merge3$竊盗總數, merge3$policenumber)
#各區警察局的數量與竊盗總數的相關係數皆趨近於零，線性關係很底。
cov(merge3$竊盗總數, merge3$policenumber)
#各區警察局的數量與竊盗總數的共變異數的絕對值皆<2,線性關係很弱。
steal.car<- rbind(car,bike)
steal.car1<-steal.car[,c(2,4,6)]
steal.car1<- group_by(steal.car1, 地區)%>%
mutate("竊盗總數"= n())
steal.car2<- steal.car1[!duplicated(steal.car1[, c("發生時段", "地區", "案類")]),]
steal.car2 <- full_join(steal.car2,policetotal,by="地區") %>%
full_join(people_taipei_area[, c(2,5)],by="地區")
#取得各區在某時段的竊盗總數、總人口數、警察局數
#-------------------------------
steal.car3 <- full_join(steal.car2, merge6[,c('地區','人口密度')], by="地區") %>%
full_join(merge6[,c('地區','camera_number')], by="地區") %>%
full_join(merge6[,c('地區','school_number')], by="地區")
qplot(竊盗總數, camera_number, data = steal.car3, main="各區域竊盜事件數與監視器相關性",xlab = "竊盜事件數", ylab = "監視器數量")
qplot(竊盗總數, school_number, data = steal.car3, main="各區域竊盜事件數與學校數相關性",xlab = "竊盜事件數", ylab = "學校數量")
qplot(竊盗總數, 人口密度, data = steal.car3, main="各區域竊盜事件數與人口密度相關性",xlab = "竊盜事件數", ylab = "人口密度")
cor(steal.car3$竊盗總數, as.numeric(steal.car3$人口密度)) #獨立
cov(steal.car3$竊盗總數, as.numeric(steal.car3$人口密度)) #正相關
cor(steal.car3$竊盗總數, steal.car3$camera_number) #　0.39
cov(steal.car3$竊盗總數, steal.car3$camera_number) #正相關
cor(steal.car3$竊盗總數, steal.car3$school_number) #  0.41
cov(steal.car3$竊盗總數, steal.car3$school_number) #正相關
#-------------------------------
qplot(竊盗總數, policenumber, data = steal.car2, main="各區域竊盜事件數與警察局的分佈相關性",xlab = "竊盜事件數", ylab = "警察局數量", color = 發生時段) +theme(text=element_text(family = "HanziPen TC Regular", size=12))
qplot(竊盗總數, people_total, data = steal.car2, main="各區域竊盜事件數與總人口數相關性",xlab = "竊盜事件數", ylab = "總人口數", color = 發生時段) +theme(text=element_text(family = "HanziPen TC Regular", size=12))
#可見人口與警察局的多寡不防礙竊盜的發生，竊盗發生的時間沒有集中的趨勢
qplot(地區, data = steal.car, main="各區域竊盜事件數")+theme(text=element_text(family = "HanziPen TC Regular", size=12))
# 大安區與北投區發生竊盗事件最高。
merge6_1 <- merge6[,(3:11)]
merge6_1$carnumber <- as.numeric(merge6_1$carnumber)
merge6_1$bikenumber <- as.numeric(merge6_1$bikenumber)
merge6_1$policenumber <- as.numeric(merge6_1$policenumber)
merge6_1$人口密度 <- as.numeric(merge6_1$人口密度)
merge6_1$camera_number <- as.numeric(merge6_1$camera_number)
merge6_1$school_number <- as.numeric(merge6_1$school_number)
library(corrplot)
M <- cor(merge6_1,method="kendall")
cor_properties <- corrplot(M, method = 'number',order ="hclust", tl.col="black", tl.cex = 1, tl.offset = 1, tl.srt = 40)
#這是R Code Chunk
# install.packages("showtext")
library(dplyr)
##library(showtext)
##showtext.auto(enable = TRUE)
library(ggplot2)
merge3<-mutate(merge3, "竊盗總數"=carnumber+bikenumber)
summary(merge3$bikenumber)
hist.bike<-merge3$bikenumber
names(hist.bike)<-merge3$地區
summary(merge3$carnumber)
hist.car<-merge3$carnumber
names(hist.car)<-merge3$地區
x.par <- par(mfrow = c(1,2))
barplot(hist.car, xlab = "區域別", ylab = "次數", main ="車在各區被竊盗的次數",density=5 , family = "HanziPen TC Regular")
barplot(hist.bike, xlab = "區域別", ylab = "次數", main ="自行車在各區被竊盗的次數",density=5, ylim=c(0, 140) , family = "HanziPen TC Regular")
par(x.par)
#車被竊盗的量比自行車的量高出很多
shapiro.test(merge3$竊盗總數)
#不服從常態分配
cor(merge3$竊盗總數, merge3$policenumber)
#各區警察局的數量與竊盗總數的相關係數皆趨近於零，線性關係很底。
cov(merge3$竊盗總數, merge3$policenumber)
#各區警察局的數量與竊盗總數的共變異數的絕對值皆<2,線性關係很弱。
steal.car<- rbind(car,bike)
steal.car1<-steal.car[,c(2,4,6)]
steal.car1<- group_by(steal.car1, 地區)%>%
mutate("竊盗總數"= n())
steal.car2<- steal.car1[!duplicated(steal.car1[, c("發生時段", "地區", "案類")]),]
steal.car2 <- full_join(steal.car2,policetotal,by="地區") %>%
full_join(people_taipei_area[, c(2,5)],by="地區")
#取得各區在某時段的竊盗總數、總人口數、警察局數
#-------------------------------
steal.car3 <- full_join(steal.car2, merge6[,c('地區','人口密度')], by="地區") %>%
full_join(merge6[,c('地區','camera_number')], by="地區") %>%
full_join(merge6[,c('地區','school_number')], by="地區")
qplot(竊盗總數, camera_number, data = steal.car3, main="各區域竊盜事件數與監視器相關性",xlab = "竊盜事件數", ylab = "監視器數量")
qplot(竊盗總數, school_number, data = steal.car3, main="各區域竊盜事件數與學校數相關性",xlab = "竊盜事件數", ylab = "學校數量")
qplot(竊盗總數, 人口密度, data = steal.car3, main="各區域竊盜事件數與人口密度相關性",xlab = "竊盜事件數", ylab = "人口密度")
cor(steal.car3$竊盗總數, as.numeric(steal.car3$人口密度)) #獨立
cov(steal.car3$竊盗總數, as.numeric(steal.car3$人口密度)) #正相關
cor(steal.car3$竊盗總數, steal.car3$camera_number) #　0.39
cov(steal.car3$竊盗總數, steal.car3$camera_number) #正相關
cor(steal.car3$竊盗總數, steal.car3$school_number) #  0.41
cov(steal.car3$竊盗總數, steal.car3$school_number) #正相關
#-------------------------------
qplot(竊盗總數, policenumber, data = steal.car2, main="各區域竊盜事件數與警察局的分佈相關性",xlab = "竊盜事件數", ylab = "警察局數量", color = 發生時段) +theme(text=element_text(family = "HanziPen TC Regular", size=12))
qplot(竊盗總數, people_total, data = steal.car2, main="各區域竊盜事件數與總人口數相關性",xlab = "竊盜事件數", ylab = "總人口數", color = 發生時段) +theme(text=element_text(family = "HanziPen TC Regular", size=12))
#可見人口與警察局的多寡不防礙竊盜的發生，竊盗發生的時間沒有集中的趨勢
qplot(地區, data = steal.car, main="各區域竊盜事件數")+theme(text=element_text(family = "HanziPen TC Regular", size=12))
# 大安區與北投區發生竊盗事件最高。
merge6_1 <- merge6[,(3:11)]
merge6_1$carnumber <- as.numeric(merge6_1$carnumber)
merge6_1$bikenumber <- as.numeric(merge6_1$bikenumber)
merge6_1$policenumber <- as.numeric(merge6_1$policenumber)
merge6_1$人口密度 <- as.numeric(merge6_1$人口密度)
merge6_1$camera_number <- as.numeric(merge6_1$camera_number)
merge6_1$school_number <- as.numeric(merge6_1$school_number)
library(corrplot)
M <- cor(merge6_1,method="kendall")
cor_properties <- corrplot(M, method = 'number',order ="hclust", tl.col="black", tl.cex = 1, tl.offset = 1, tl.srt = 40)
